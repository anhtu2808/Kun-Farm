@page "/leaderboard"
@model KunFarm.Presentation.Pages.Leaderboard.IndexModel
@{
    ViewData["Title"] = "KunFarm Leaderboard";
}

<!-- Header Section -->
<div class="relative bg-gradient-to-r from-farm-yellow to-orange-400 rounded-2xl p-6 md:p-8 mb-8 overflow-hidden">
    <div class="absolute inset-0 bg-black opacity-10 rounded-2xl"></div>
    <div class="relative z-10 text-white">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold mb-2">
                    <i class="fas fa-trophy mr-3 text-farm-yellow"></i>
                    KunFarm Leaderboard
                </h1>
                <p class="text-lg opacity-90">
                    Track the achievements of the most successful farmers
                </p>
            </div>
            <!-- Decorative farm icons -->
            <div class="hidden md:flex space-x-4 text-farm-yellow opacity-30">
                <i class="fas fa-medal text-4xl"></i>
                <i class="fas fa-crown text-4xl"></i>
                <i class="fas fa-star text-4xl"></i>
            </div>
        </div>
    </div>
</div>

<!-- Leaderboard Content -->
<div class="bg-white rounded-2xl shadow-lg overflow-hidden">
    <!-- Money Leaderboard -->
    <div id="money-content" class="p-6">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-900 flex items-center mb-4 sm:mb-0">
                <i class="fas fa-coins text-farm-yellow mr-3"></i>
                Money Rankings
            </h2>
            <button onclick="loadMoneyLeaderboard()" 
                    class="bg-farm-yellow hover:bg-yellow-500 text-gray-900 px-4 py-2 rounded-lg font-semibold transition-colors duration-200 flex items-center">
                <i class="fas fa-sync-alt mr-2"></i>
                Refresh
            </button>
        </div>
        
        <!-- Top 3 Podium -->
        <div id="money-podium" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <!-- Podium will be generated by JavaScript -->
        </div>
        
        <!-- Leaderboard Table -->
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-gradient-to-r from-farm-yellow to-yellow-400 text-gray-900">
                    <tr>
                        <th class="px-4 py-3 text-left font-semibold">Rank</th>
                        <th class="px-4 py-3 text-left font-semibold">Player</th>
                        <th class="px-4 py-3 text-left font-semibold hidden sm:table-cell">Display Name</th>
                        <th class="px-4 py-3 text-right font-semibold">Money</th>
                        <th class="px-4 py-3 text-right font-semibold hidden lg:table-cell">Last Active</th>
                    </tr>
                </thead>
                <tbody id="moneyLeaderboardBody" class="divide-y divide-gray-200">
                    <!-- Data will be loaded here -->
                </tbody>
            </table>
        </div>
        
        <div id="moneyLoadingIndicator" class="text-center py-8 hidden">
            <div class="inline-flex items-center px-4 py-2 rounded-lg bg-farm-yellow/10">
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-farm-yellow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span class="text-farm-yellow font-semibold">Loading leaderboard...</span>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Panel -->
<div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="bg-white rounded-xl shadow-lg p-6">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-farm-blue bg-opacity-10">
                <i class="fas fa-users text-farm-blue text-xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Total Players</p>
                <p id="totalPlayersCount" class="text-2xl font-bold text-gray-900">-</p>
            </div>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow-lg p-6">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-green-100">
                <i class="fas fa-signal text-green-600 text-xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Active Players</p>
                <p id="activePlayersCount" class="text-2xl font-bold text-gray-900">-</p>
            </div>
        </div>
    </div>
    
    <div class="bg-white rounded-xl shadow-lg p-6">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-farm-yellow bg-opacity-10">
                <i class="fas fa-clock text-farm-yellow text-xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Last Updated</p>
                <p id="lastUpdated" class="text-sm font-semibold text-gray-900">-</p>
            </div>
        </div>
    </div>
</div>

<!-- Player Detail Modal -->
<div id="playerDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl max-w-md w-full mx-4 p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold text-gray-900">Player Details</h3>
            <button onclick="closePlayerModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        
        <div id="playerDetailContent" class="space-y-4">
            <!-- Content will be generated by JavaScript -->
        </div>
        
        <div class="mt-6 text-center">
            <button onclick="closePlayerModal()" 
                    class="bg-farm-blue hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors duration-200">
                Close
            </button>
        </div>
    </div>
</div>

<!-- Include the main leaderboard script -->
<script src="~/js/leaderboard.js"></script>

<!-- CSS for styling -->
<style>
    .active-tab {
        background: linear-gradient(to right, var(--farm-yellow), #fbbf24);
        color: #1f2937;
        font-weight: 600;
    }
    
    .tab-button {
        border: none;
        outline: none;
        cursor: pointer;
    }
    
    .tab-button:focus {
        outline: 2px solid var(--farm-yellow);
        outline-offset: -2px;
    }
    
    .podium-card {
        transform: translateY(0);
        transition: transform 0.3s ease;
    }
    
    .podium-card:hover {
        transform: translateY(-5px);
    }
    
    .leaderboard-row {
        cursor: pointer;
        transition: background-color 0.2s ease;
    }
    
    .leaderboard-row:hover {
        background-color: #f9fafb;
    }
    
    :root {
        --farm-yellow: #f59e0b;
        --farm-green: #10b981;
        --farm-blue: #3b82f6;
    }
</style>

<script>
    // Initialize the leaderboard when page loads
    document.addEventListener('DOMContentLoaded', function() {
        loadMoneyLeaderboard();
    });

    function closePlayerModal() {
        document.getElementById('playerDetailModal').classList.add('hidden');
    }
</script> 